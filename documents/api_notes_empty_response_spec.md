# Спецификация ответа API при отсутствии данных (для коллекций)

## Задача

Определить стандарт ответа API для случая, когда запрашиваемая коллекция ресурсов (например, заметки) пуста или отсутствуют данные, соответствующие критериям запроса. Это необходимо для корректной обработки таких ситуаций на стороне клиента (фронтенда) и отображения "пустого состояния" вместо ошибки.

## Рекомендуемый стандарт ответа API

*   **HTTP Статус:** `200 OK`
*   **Тело ответа (Content-Type: application/json):**
    ```json
    []
    ```

## Описание

Когда клиент выполняет запрос на получение коллекции ресурсов (например, `GET /notes`, `GET /tasks/by-week/{weekId}` и т.п.), и сервер успешно обрабатывает запрос, но не находит ресурсов, соответствующих указанным критериям, сервер должен:

1.  Вернуть HTTP статус `200 OK`. Это означает, что сам запрос был корректен и успешно обработан сервером.
2.  В теле ответа вернуть пустой JSON массив `[]`. Это явно указывает на то, что коллекция запрошенных ресурсов пуста.

## Диаграмма логики ответа

```mermaid
graph TD
    A[Клиент: Запрос на получение коллекции ресурсов] --> B{Сервер: Данные найдены согласно критериям запроса?};
    B -- Да --> C[Сервер: HTTP 200 OK + JSON с массивом данных];
    B -- Нет --> D[Сервер: HTTP 200 OK + JSON с пустым массивом []];
    C --> E[Клиент: Обработка и отображение данных];
    D --> F[Клиент: Обработка пустого массива, отображение "пустого состояния"];
```

## Обоснование выбора

*   **Простота для клиента:**
    *   Клиенту не требуется обрабатывать различные HTTP статусы для случаев "данные есть" и "данных нет".
    *   Логика обработки ответа на стороне клиента упрощается: всегда ожидается JSON массив, и для проверки наличия данных достаточно проверить его длину (например, `if (data.length === 0)`).
*   **Консистентность и семантика HTTP:**
    *   Статус `200 OK` корректно отражает успешное выполнение запроса. Отсутствие данных по запросу не является ошибкой сервера или ошибкой в самом запросе.
    *   Статус `204 No Content` чаще используется для операций, которые не возвращают тело ответа по своей природе (например, `DELETE`), или для одиночных ресурсов, которые существуют, но не имеют содержимого. Для коллекций он менее интуитивен и может усложнить обработку на клиенте, который обычно ожидает структуру (пусть и пустую).
*   **Общепринятая практика:**
    *   Возврат `200 OK` с пустым массивом является широко распространенным и рекомендуемым подходом в REST API для представления пустых коллекций.

## Применение к проблеме "Корректная обработка отсутствия заметок при переключении недель"

В контексте задачи №4 ([`PLAN_01_06_2025.md`](PLAN_01_06_2025.md:70)), если фронтенд запрашивает заметки (например, все заметки через `GET /notes` или заметки за неделю через специализированный эндпоинт) и получает `200 OK` с `[]`, он должен интерпретировать это как отсутствие заметок для данного периода и отобразить соответствующее "пустое состояние", а не ошибку "not found".

Текущий эндпоинт `GET /notes` уже соответствует этому стандарту, возвращая `200 OK` с `[]` если в базе нет ни одной заметки. Проблема отображения ошибки "not found" при переключении на неделю без заметок, скорее всего, кроется в логике фронтенда, который должен корректно обрабатывать пустой массив после локальной фильтрации.